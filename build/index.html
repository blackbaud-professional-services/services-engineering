<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="CnvHeaderVersion" content="v5.0"/><title data-react-helmet="true">Build | Services Engineering</title><link rel="stylesheet" href="/services-engineering/main-88ff4ca322d1d509894d.css"/><link href="https://fonts.googleapis.com/css?family=Montserrat:400,900" rel="stylesheet"/><style>.cxsync-279093126{display:flex;align-items:stretch;justify-content:flex-start;min-height:100vh;color:#444;font-family:Montserrat, Arial, sans-serif}.cxsync-2249242545{flex:0 0 15rem;padding:3rem 1.5rem;background-color:#F4F4F4}.cxsync-2957022663{flex:1;padding:3rem;max-width:60rem}.cxsync-3751804845{}.cxsync-3751804845 ul{margin:-1.5rem}.cxsync-3751804845 li{margin:1.5rem}.cxsync-2423527651{font-family:Montserrat, Arial, sans-serif;font-weight:900}.cxsync-1263781436{margin-bottom:1.5rem}.cxsync-324972854{font-family:Montserrat, Arial, sans-serif;font-weight:900;font-size:2.48832rem;margin-top:1.5rem;margin-bottom:1.5rem}.cxsync-324972854:first-child{margin-top:0px}.cxsync-2590042826{}.cxsync-2590042826 h1{padding:3rem 0 1.5rem}.cxsync-2590042826 h2{padding:3rem 0 1.5rem}.cxsync-2590042826 h3{padding:3rem 0 1.5rem}.cxsync-2590042826 a{opacity:0.75;border-bottom:2px solid #8BBF47;transition:ease-out .25s}.cxsync-2590042826 a:hover{opacity:1}.cxsync-2590042826 .highlight{background-color:#E7F2D9}.cxsync-137111509{font-family:Montserrat, Arial, sans-serif}.cxsync-137111509 p{padding-bottom:1.5rem;line-height:1.5}.cxsync-137111509 ul{list-style-type:disc;list-style-position:outside;padding-bottom:1.5rem;line-height:1.5}.cxsync-137111509 ol{list-style-type:decimal;list-style-position:outside;padding-bottom:1.5rem;line-height:1.5}.cxsync-137111509 li{margin-left:1.5rem}.cxsync-137111509 blockquote{max-width:37.5rem;padding-bottom:1.5rem;margin:0 auto;text-align:center;line-height:1.5;font-weight:700;font-size:1.2rem}.cxsync-137111509 blockquote:before{content:open-quote}.cxsync-137111509 blockquote:after{content:close-quote}.cxsync-137111509 img{display:block;margin:0 auto;width:auto;max-width:100%}.cxsync-137111509 iframe{padding-bottom:3rem}.cxsync-137111509 strong{font-weight:700}.cxsync-137111509 em{font-style:italic}.cxsync-137111509 h1{font-family:Montserrat, Arial, sans-serif;font-weight:900;font-size:2.0736rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-137111509 h2{font-family:Montserrat, Arial, sans-serif;font-weight:900;font-size:1.728rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-137111509 h3{font-family:Montserrat, Arial, sans-serif;font-weight:900;font-size:1.44rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-137111509 h4{font-family:Montserrat, Arial, sans-serif;font-weight:900;font-size:1.2rem;padding-bottom:1.5rem}.cxsync-137111509 h5{font-family:Montserrat, Arial, sans-serif;font-weight:900;font-size:1rem;padding-bottom:1.5rem}.cxsync-137111509 h6{font-family:Montserrat, Arial, sans-serif;font-weight:900;font-size:0.8333333333333334rem;padding-bottom:1.5rem}.cxsync-137111509 a{opacity:0.75;border-bottom:2px solid #8BBF47;transition:ease-out .25s}.cxsync-137111509 a:hover{opacity:1}.cxsync-137111509 .highlight{background-color:#E7F2D9}.cxsync-2282092937{position:relative;margin-top:0.75rem;margin-bottom:1.5rem;padding:0.75rem 1.5rem;background-color:#F4F4F4;font-size:0.8333333333333334rem;line-height:1.75}.cxsync-4258600099{position:absolute;bottom:100%;right:0px;padding:0.375rem 0.75rem;background-color:#F4F4F4;font-size:0.6944444444444444rem}</style><script>
          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
          })(window,document,'script','dataLayer','GTM-PN6K34');</script></head><body><main id="mount"><div class="cxsync-279093126" data-reactroot="" data-reactid="1" data-react-checksum="-2142037401"><aside class="cxsync-2249242545" data-reactid="2"><nav class="cxsync-3751804845" data-reactid="3"><ul data-reactid="4"><li data-reactid="5"><a href="/services-engineering/" data-reactid="6">Overview</a></li><li data-reactid="7"><a href="/services-engineering/getting-started" data-reactid="8">Getting Started</a></li><li data-reactid="9"><a href="/services-engineering/components" data-reactid="10">Components</a></li><li data-reactid="11"><a href="/services-engineering/routing" data-reactid="12">Routing</a></li><li data-reactid="13"><a href="/services-engineering/state" data-reactid="14">State</a></li><li data-reactid="15"><a href="/services-engineering/styles" data-reactid="16">Styles</a></li><li data-reactid="17"><a href="/services-engineering/content" data-reactid="18">Content</a></li><li data-reactid="19"><a href="/services-engineering/integration" data-reactid="20">Integration</a></li><li data-reactid="21"><a href="/services-engineering/tests" data-reactid="22">Tests</a></li><li data-reactid="23"><a href="/services-engineering/build" class="cxsync-2423527651" data-reactid="24">Build</a></li><li data-reactid="25"><a href="/services-engineering/deploy" data-reactid="26">Deploy</a></li></ul></nav></aside><section class="cxsync-2957022663" data-reactid="27"><div data-reactid="28"><!-- react-empty: 29 --><h2 class="c11n-heading cxsync-324972854" data-reactid="30">Build</h2><div class="c11n-rich-text cxsync-137111509" data-reactid="31"><h3 data-reactid="32">Build</h3><p data-reactid="33">The aim of the build step is to transpile our JavaScript and bundle our assets into the dist folder ready for deployment. As we are creating isomorphic JavaScript apps, the output of our build will contain the following.</p><ul data-reactid="34"><li data-reactid="35"><span class="highlight" data-reactid="36">server.js</span><!-- react-text: 37 -->: this is the compiled version of our project&#x27;s server.js<!-- /react-text --></li><li data-reactid="38"><span class="highlight" data-reactid="39">main.js</span><!-- react-text: 40 -->: this is the compiled version of our project&#x27;s client.js<!-- /react-text --></li><li data-reactid="41"><span class="highlight" data-reactid="42">main.css</span><!-- react-text: 43 -->: any imported CSS such as our CSS reset<!-- /react-text --></li><li data-reactid="44">Other assets such as images and fonts</li></ul><p data-reactid="45"><!-- react-text: 46 -->Note that if we run the build and <!-- /react-text --><span class="highlight" data-reactid="47">NODE_ENV=production</span><!-- react-text: 48 -->, there are a couple of small differences, mainly that our main js and css files will include a hash in the filename, which is used to ensure browsers don&#x27;t cache old versions.<!-- /react-text --></p><h3 data-reactid="49">Build Scripts</h3><p data-reactid="50"><!-- react-text: 51 -->Our build related scripts will look something like the following. The base <!-- /react-text --><span class="highlight" data-reactid="52">build</span><!-- react-text: 53 --> script is used as a baseline, whereas <!-- /react-text --><span class="highlight" data-reactid="54">build:staging</span><!-- react-text: 55 --> and <!-- /react-text --><span class="highlight" data-reactid="56">build:prod</span><!-- react-text: 57 --> are used to pass in specific environment variables.<!-- /react-text --></p><div class="cxsync-2282092937" data-reactid="58"><span class="cxsync-4258600099" data-reactid="59">json</span><pre data-reactid="60"><code data-reactid="61">{
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;brb build --config=&#x27;./webpack.shared.config&#x27; --base-path=$BASE_PATH&quot;,
    &quot;build:staging&quot;: &quot;BASE_PATH=&#x27;/repo-name/&#x27; yarn build&quot;,
    &quot;build:prod&quot;: &quot;NODE_ENV=&#x27;production&#x27; yarn build&quot;
  }
}</code></pre></div><p data-reactid="62"><!-- react-text: 63 -->The <!-- /react-text --><span class="highlight" data-reactid="64">BASE_PATH</span><!-- react-text: 65 --> variable is used to set the base path that our application is served from, which we use when our app might not be served from the root e.g. when hosted on Github pages.<!-- /react-text --></p><p data-reactid="66">So to build our app for staging, we would run:</p><div class="cxsync-2282092937" data-reactid="67"><span class="cxsync-4258600099" data-reactid="68">json</span><pre data-reactid="69"><code data-reactid="70">yarn build:staging</code></pre></div><p data-reactid="71">So to build our app for production, we would run:</p><div class="cxsync-2282092937" data-reactid="72"><span class="cxsync-4258600099" data-reactid="73">json</span><pre data-reactid="74"><code data-reactid="75">yarn build:prod</code></pre></div><h3 data-reactid="76">Static Routes</h3><p data-reactid="77"><!-- react-text: 78 -->An important concept in our build is the concept of static routes. In our <!-- /react-text --><span class="highlight" data-reactid="79">source/server.js</span><!-- react-text: 80 -->, we often specify routes in <!-- /react-text --><span class="highlight" data-reactid="81">app.staticRoutes</span><!-- react-text: 82 -->. A static pre-rendered HTML file will be generated, during the build, for each of these routes.<!-- /react-text --></p><p data-reactid="83">As opposed to other Isomorphic React apps, where a server receives requests and generates HTML at runtime, we are doing that up front during the build, which effectively lets us deploy completely static sites to S3, without having any of the usual overhead of managing a server.</p><div class="cxsync-2282092937" data-reactid="84"><span class="cxsync-4258600099" data-reactid="85">javascript</span><pre data-reactid="86"><code data-reactid="87">app.staticRoutes = [
  &#x27;/&#x27;,
  &#x27;/about&#x27;,
  &#x27;/faqs&#x27;
]</code></pre></div><p data-reactid="88"><!-- react-text: 89 -->If we specified the staticRoutes as above, our build would bundle the usual assets, but also render a <!-- /react-text --><span class="highlight" data-reactid="90">index.html</span><!-- react-text: 91 -->, <!-- /react-text --><span class="highlight" data-reactid="92">about/index.html</span><!-- react-text: 93 --> and <!-- /react-text --><span class="highlight" data-reactid="94">faqs/index.html</span><!-- react-text: 95 -->.<!-- /react-text --></p><p data-reactid="96">These generated HTML pages have a couple of important characteristics worth noting.</p><ul data-reactid="97"><li data-reactid="98"><!-- react-text: 99 -->They include our <!-- /react-text --><span class="highlight" data-reactid="100">main.js</span><!-- react-text: 101 -->, which means our app will load and run in the browser, so subsequent route changes can be handled completely client side<!-- /react-text --></li><li data-reactid="102">The complete state of our Redux store during the build, is serialized into a script tag, which is then reloaded back into the store when it loads in the browser</li></ul></div></div></section></div></main><script id="initial-state" type="application/json">{"blank":{}}</script><script src="/services-engineering/main-88ff4ca322d1d509894d.js"></script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PN6K34" height="0" width="0" style="display:none;visibility:hidden;"></iframe></noscript></body></html>