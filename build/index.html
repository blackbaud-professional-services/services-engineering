<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="CnvHeaderVersion" content="v5.0"/><title data-react-helmet="true">Build | Services Engineering</title><link rel="stylesheet" href="/services-engineering/main-6be92edc0492d141c392.css"/><link rel="icon" type="image/png" href="/services-engineering/3da6f308c48368a5ae9ab541b51f9c45.png"/><style>.cxsync-3701282619{padding-top:3rem;color:#282828;font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-2064477598{padding:6rem 1.5rem;margin:0 auto;max-width:60rem}.cxsync-1367606422{padding:3rem 1.5rem;margin:0 auto;max-width:60rem}.cxsync-2345956983{max-width:39rem}.cxsync-1295578920{transform:translateZ(0);transition:all 1s ease;position:fixed;top:0px;left:0px;right:0px;background:white;z-index:1}.cxsync-990967205{padding:1.5rem;margin:0 auto;width:100%;max-width:60rem;font-weight:500;display:flex;justify-content:space-between;align-items:center}.cxsync-1131475801{font-size:20px;position:relative;top:0.12em;display:inline-block}.cxsync-2990027002{max-width:39rem}.cxsync-2990027002 h1{padding:3rem 0 1.5rem}.cxsync-2990027002 h2{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;padding:3rem 0 1.5rem}.cxsync-2990027002 h3{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;padding:3rem 0 1.5rem}.cxsync-2990027002 h4{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-2990027002 h5{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-2990027002 h6{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-2990027002 a{border-bottom:2px solid #282828}.cxsync-2990027002 .highlight{display:inline-block;margin:-0.1875rem;padding:0.1875rem;background-color:#eee}.cxsync-2990027002 > :first-child{padding-top:0px}.cxsync-2415678169{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;max-width:39rem}.cxsync-2415678169 p{padding-bottom:1.5rem;line-height:1.5}.cxsync-2415678169 ul{list-style-type:disc;list-style-position:outside;padding-bottom:1.5rem;line-height:1.5}.cxsync-2415678169 ol{list-style-type:decimal;list-style-position:outside;padding-bottom:1.5rem;line-height:1.5}.cxsync-2415678169 li{margin-left:1.5rem}.cxsync-2415678169 blockquote{max-width:37.5rem;padding-bottom:1.5rem;margin:0 auto;text-align:center;line-height:1.5;font-weight:700;font-size:1.2rem}.cxsync-2415678169 blockquote:before{content:open-quote}.cxsync-2415678169 blockquote:after{content:close-quote}.cxsync-2415678169 img{display:block;margin:0 auto;width:auto;max-width:100%}.cxsync-2415678169 iframe{padding-bottom:3rem}.cxsync-2415678169 strong{font-weight:700}.cxsync-2415678169 em{font-style:italic}.cxsync-2415678169 h1{font-family:"helvetica neue", arial, sans-serif;font-weight:400;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:2.0736rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-2415678169 h2{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1.728rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-2415678169 h3{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1.44rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-2415678169 h4{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1.2rem;padding-bottom:1.5rem}.cxsync-2415678169 h5{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1rem;padding-bottom:1.5rem}.cxsync-2415678169 h6{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:0.8333333333333334rem;padding-bottom:1.5rem}.cxsync-2415678169 a{border-bottom:2px solid #282828}.cxsync-2415678169 .highlight{display:inline-block;margin:-0.1875rem;padding:0.1875rem;background-color:#eee}.cxsync-2415678169 > :first-child{padding-top:0px}.cxsync-136603613{max-width:27rem}.cxsync-136603613 h1{padding:3rem 0 1.5rem}.cxsync-136603613 h2{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;padding:3rem 0 1.5rem}.cxsync-136603613 h3{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;padding:3rem 0 1.5rem}.cxsync-136603613 h4{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-136603613 h5{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-136603613 h6{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-136603613 a{border-bottom:2px solid #282828}.cxsync-136603613 .highlight{display:inline-block;margin:-0.1875rem;padding:0.1875rem;background-color:#eee}.cxsync-136603613 > :first-child{padding-top:0px}.cxsync-1745152266{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;max-width:27rem}.cxsync-1745152266 p{padding-bottom:1.5rem;line-height:1.5}.cxsync-1745152266 ul{list-style-type:disc;list-style-position:outside;padding-bottom:1.5rem;line-height:1.5}.cxsync-1745152266 ol{list-style-type:decimal;list-style-position:outside;padding-bottom:1.5rem;line-height:1.5}.cxsync-1745152266 li{margin-left:1.5rem}.cxsync-1745152266 blockquote{max-width:37.5rem;padding-bottom:1.5rem;margin:0 auto;text-align:center;line-height:1.5;font-weight:700;font-size:1.2rem}.cxsync-1745152266 blockquote:before{content:open-quote}.cxsync-1745152266 blockquote:after{content:close-quote}.cxsync-1745152266 img{display:block;margin:0 auto;width:auto;max-width:100%}.cxsync-1745152266 iframe{padding-bottom:3rem}.cxsync-1745152266 strong{font-weight:700}.cxsync-1745152266 em{font-style:italic}.cxsync-1745152266 h1{font-family:"helvetica neue", arial, sans-serif;font-weight:400;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:2.0736rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-1745152266 h2{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1.728rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-1745152266 h3{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1.44rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-1745152266 h4{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1.2rem;padding-bottom:1.5rem}.cxsync-1745152266 h5{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1rem;padding-bottom:1.5rem}.cxsync-1745152266 h6{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:0.8333333333333334rem;padding-bottom:1.5rem}.cxsync-1745152266 a{border-bottom:2px solid #282828}.cxsync-1745152266 .highlight{display:inline-block;margin:-0.1875rem;padding:0.1875rem;background-color:#eee}.cxsync-1745152266 > :first-child{padding-top:0px}.cxsync-3712203969{border-bottom:2px solid #f5f5f5}.cxsync-594816135{display:flex;flex-wrap:wrap;margin-left:-0.75rem;margin-right:-0.75rem}.cxsync-1654653318{display:block;padding:0.75rem;font-size:0.9128709291752769rem;border-bottom:2px solid transparent}.cxsync-1662634949{padding-right:1.5rem;padding-left:1.5rem;margin:0 auto;max-width:60rem}.cxsync-3645621543{border-bottom:2px solid #282828}.cxsync-343116390{}.cxsync-343116390 h1{padding:3rem 0 1.5rem}.cxsync-343116390 h2{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;padding:3rem 0 1.5rem}.cxsync-343116390 h3{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;padding:3rem 0 1.5rem}.cxsync-343116390 h4{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-343116390 h5{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-343116390 h6{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-343116390 a{border-bottom:2px solid #282828}.cxsync-343116390 .highlight{display:inline-block;margin:-0.1875rem;padding:0.1875rem;background-color:#eee}.cxsync-343116390 > :first-child{padding-top:0px}.cxsync-1076432855{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased}.cxsync-1076432855 p{padding-bottom:1.5rem;line-height:1.5}.cxsync-1076432855 ul{list-style-type:disc;list-style-position:outside;padding-bottom:1.5rem;line-height:1.5}.cxsync-1076432855 ol{list-style-type:decimal;list-style-position:outside;padding-bottom:1.5rem;line-height:1.5}.cxsync-1076432855 li{margin-left:1.5rem}.cxsync-1076432855 blockquote{max-width:37.5rem;padding-bottom:1.5rem;margin:0 auto;text-align:center;line-height:1.5;font-weight:700;font-size:1.2rem}.cxsync-1076432855 blockquote:before{content:open-quote}.cxsync-1076432855 blockquote:after{content:close-quote}.cxsync-1076432855 img{display:block;margin:0 auto;width:auto;max-width:100%}.cxsync-1076432855 iframe{padding-bottom:3rem}.cxsync-1076432855 strong{font-weight:700}.cxsync-1076432855 em{font-style:italic}.cxsync-1076432855 h1{font-family:"helvetica neue", arial, sans-serif;font-weight:400;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:2.0736rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-1076432855 h2{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1.728rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-1076432855 h3{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1.44rem;padding-bottom:1.5rem;padding:3rem 0 1.5rem}.cxsync-1076432855 h4{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1.2rem;padding-bottom:1.5rem}.cxsync-1076432855 h5{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:1rem;padding-bottom:1.5rem}.cxsync-1076432855 h6{font-family:"helvetica neue", arial, sans-serif;font-weight:500;line-height:1.5;-webkit-font-smoothing:antialiased;font-size:0.8333333333333334rem;padding-bottom:1.5rem}.cxsync-1076432855 a{border-bottom:2px solid #282828}.cxsync-1076432855 .highlight{display:inline-block;margin:-0.1875rem;padding:0.1875rem;background-color:#eee}.cxsync-1076432855 > :first-child{padding-top:0px}.cxsync-380989135{position:relative;margin-top:3.75rem;margin-bottom:3rem;padding:0.75rem 1.5rem;background-color:#f5f5f5;font-size:0.8333333333333334rem;line-height:1.75;font-family:monaco, Consolas, "Lucida Console", monospace}.cxsync-380989135 > pre{white-space:pre;overflow:auto}.cxsync-2589499036{position:absolute;bottom:100%;right:0px;padding:0.375rem 0.75rem;background-color:#f5f5f5;font-size:0.6944444444444444rem}</style><script>
          (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
          new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
          j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
          'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
          })(window,document,'script','dataLayer','GTM-PN6K34');</script></head><body><main id="mount"><div class="cxsync-3701282619" data-reactroot="" data-reactid="1" data-react-checksum="-1490731063"><div style="box-shadow:0 15px 30px 0 rgba(0,0,0,0.00);" class="cxsync-1295578920" data-reactid="2"><div class="cxsync-990967205" data-reactid="3"><a href="/services-engineering/" data-reactid="4"><span class="cxsync-1131475801" data-reactid="5">ðŸ–¥</span><!-- react-text: 6 --> Services Engineering<!-- /react-text --></a><div data-reactid="7"></div></div></div><div class="cxsync-2064477598" data-reactid="8"><div class="c11n-rich-text cxsync-2415678169" data-reactid="9"><h1 data-reactid="10">The following is a guide to how we build apps in services. We mostly build Universal JavaScript apps, and we have a collection of tools to help us.</h1></div><div class="c11n-rich-text cxsync-1745152266" data-reactid="11"><p data-reactid="12">Universal, or Isomorphic, JavaScript describes applications where the same codebase runs both on the server and in the browser.</p></div></div><nav class="cxsync-3712203969" data-reactid="13"><div class="cxsync-1662634949" data-reactid="14"><ul class="cxsync-594816135" data-reactid="15"><li data-reactid="16"><a class="cxsync-1654653318" href="/services-engineering/" data-reactid="17">Getting Started</a></li><li data-reactid="18"><a class="cxsync-1654653318" href="/services-engineering/components" data-reactid="19">Components</a></li><li data-reactid="20"><a class="cxsync-1654653318" href="/services-engineering/routing" data-reactid="21">Routing</a></li><li data-reactid="22"><a class="cxsync-1654653318" href="/services-engineering/state" data-reactid="23">State</a></li><li data-reactid="24"><a class="cxsync-1654653318" href="/services-engineering/styles" data-reactid="25">Styles</a></li><li data-reactid="26"><a class="cxsync-1654653318" href="/services-engineering/content" data-reactid="27">Content</a></li><li data-reactid="28"><a class="cxsync-1654653318" href="/services-engineering/integration" data-reactid="29">Integration</a></li><li data-reactid="30"><a class="cxsync-1654653318" href="/services-engineering/tests" data-reactid="31">Tests</a></li><li data-reactid="32"><a class="cxsync-1654653318 cxsync-3645621543" href="/services-engineering/build" data-reactid="33">Build</a></li><li data-reactid="34"><a class="cxsync-1654653318" href="/services-engineering/deploy" data-reactid="35">Deploy</a></li><li data-reactid="36"><a class="cxsync-1654653318" href="/services-engineering/rails" data-reactid="37">Rails</a></li></ul></div></nav><section class="cxsync-1367606422" data-reactid="38"><div class="cxsync-2345956983" data-reactid="39"><div data-reactid="40"><!-- react-empty: 41 --><div class="c11n-rich-text cxsync-1076432855" data-reactid="42"><h3 data-reactid="43">Build</h3><p data-reactid="44">The aim of the build step is to transpile our JavaScript and bundle our assets into the dist folder ready for deployment. As we are creating isomorphic JavaScript apps, the output of our build will contain the following.</p><ul data-reactid="45"><li data-reactid="46"><span class="highlight" data-reactid="47">server.js</span><!-- react-text: 48 -->: this is the compiled version of our project&#x27;s server.js<!-- /react-text --></li><li data-reactid="49"><span class="highlight" data-reactid="50">main.js</span><!-- react-text: 51 -->: this is the compiled version of our project&#x27;s client.js<!-- /react-text --></li><li data-reactid="52"><span class="highlight" data-reactid="53">main.css</span><!-- react-text: 54 -->: any imported CSS such as our CSS reset<!-- /react-text --></li><li data-reactid="55">Other assets such as images and fonts</li></ul><p data-reactid="56"><!-- react-text: 57 -->Note that if we run the build and <!-- /react-text --><span class="highlight" data-reactid="58">NODE_ENV=production</span><!-- react-text: 59 -->, there are a couple of small differences, mainly that our main js and css files will include a hash in the filename, which is used to ensure browsers don&#x27;t cache old versions.<!-- /react-text --></p><h3 data-reactid="60">Build Scripts</h3><p data-reactid="61"><!-- react-text: 62 -->Our build related scripts will look something like the following. The base <!-- /react-text --><span class="highlight" data-reactid="63">build</span><!-- react-text: 64 --> script is used as a baseline, whereas <!-- /react-text --><span class="highlight" data-reactid="65">build:staging</span><!-- react-text: 66 --> and <!-- /react-text --><span class="highlight" data-reactid="67">build:prod</span><!-- react-text: 68 --> are used to pass in specific environment variables.<!-- /react-text --></p><div class="cxsync-380989135" data-reactid="69"><span class="cxsync-2589499036" data-reactid="70">json</span><pre data-reactid="71"><code data-reactid="72">{
  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;brb build --config=&#x27;./webpack.shared.config&#x27; --base-path=$BASE_PATH&quot;,
    &quot;build:staging&quot;: &quot;BASE_PATH=&#x27;/repo-name/&#x27; yarn build&quot;,
    &quot;build:prod&quot;: &quot;NODE_ENV=&#x27;production&#x27; yarn build&quot;
  }
}</code></pre></div><p data-reactid="73"><!-- react-text: 74 -->The <!-- /react-text --><span class="highlight" data-reactid="75">BASE_PATH</span><!-- react-text: 76 --> variable is used to set the base path that our application is served from, which we use when our app might not be served from the root e.g. when hosted on Github pages.<!-- /react-text --></p><p data-reactid="77">So to build our app for staging, we would run:</p><div class="cxsync-380989135" data-reactid="78"><span class="cxsync-2589499036" data-reactid="79">json</span><pre data-reactid="80"><code data-reactid="81">yarn build:staging</code></pre></div><p data-reactid="82">So to build our app for production, we would run:</p><div class="cxsync-380989135" data-reactid="83"><span class="cxsync-2589499036" data-reactid="84">json</span><pre data-reactid="85"><code data-reactid="86">yarn build:prod</code></pre></div><h3 data-reactid="87">Static Routes</h3><p data-reactid="88"><!-- react-text: 89 -->An important concept in our build is the concept of static routes. In our <!-- /react-text --><span class="highlight" data-reactid="90">source/server.js</span><!-- react-text: 91 -->, we often specify routes in <!-- /react-text --><span class="highlight" data-reactid="92">app.staticRoutes</span><!-- react-text: 93 -->. A static pre-rendered HTML file will be generated, during the build, for each of these routes.<!-- /react-text --></p><p data-reactid="94">As opposed to other Isomorphic React apps, where a server receives requests and generates HTML at runtime, we are doing that up front during the build, which effectively lets us deploy completely static sites to S3, without having any of the usual overhead of managing a server.</p><div class="cxsync-380989135" data-reactid="95"><span class="cxsync-2589499036" data-reactid="96">javascript</span><pre data-reactid="97"><code data-reactid="98">app.staticRoutes = [
  &#x27;/&#x27;,
  &#x27;/about&#x27;,
  &#x27;/faqs&#x27;
]</code></pre></div><p data-reactid="99"><!-- react-text: 100 -->If we specified the staticRoutes as above, our build would bundle the usual assets, but also render a <!-- /react-text --><span class="highlight" data-reactid="101">index.html</span><!-- react-text: 102 -->, <!-- /react-text --><span class="highlight" data-reactid="103">about/index.html</span><!-- react-text: 104 --> and <!-- /react-text --><span class="highlight" data-reactid="105">faqs/index.html</span><!-- react-text: 106 -->.<!-- /react-text --></p><p data-reactid="107">These generated HTML pages have a couple of important characteristics worth noting.</p><ul data-reactid="108"><li data-reactid="109"><!-- react-text: 110 -->They include our <!-- /react-text --><span class="highlight" data-reactid="111">main.js</span><!-- react-text: 112 -->, which means our app will load and run in the browser, so subsequent route changes can be handled completely client side<!-- /react-text --></li><li data-reactid="113">The complete state of our Redux store during the build, is serialized into a script tag, which is then reloaded back into the store when it loads in the browser</li></ul></div></div></div></section></div></main><script id="initial-state" type="application/json">{"blank":{}}</script><script src="/services-engineering/main-6be92edc0492d141c392.js"></script><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PN6K34" height="0" width="0" style="display:none;visibility:hidden;"></iframe></noscript></body></html>